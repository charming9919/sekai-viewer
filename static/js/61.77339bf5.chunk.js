(this["webpackJsonpsekai-viewer"]=this["webpackJsonpsekai-viewer"]||[]).push([[61],{1059:function(e,t,a){"use strict";a.r(t);var r=a(1),n=a(5),i=a.n(n),c=a(9),o=a(11),s=a(54),d=a(281),u=a(473),l=a(43),b=a.n(l),f=a(0),m=a(188),p=a(19),g=a(37),h=a(292),j=a(108);t.default=function(){var e=Object(h.a)(),t=Object(m.a)().t,a=Object(p.i)().provider,n=Object(f.useContext)(g.c),l=n.updateUser,v=n.updateJwtToken,O=n.updateUserMeta,x=Object(p.h)(),k=Object(p.g)(),y=Object(j.e)(),w=y.getConnectCallback,C=y.getUserMetadataMe,I=y.postUpload,S=Object(f.useState)(0),P=Object(o.a)(S,2),B=P[0],z=P[1],N=Object(f.useState)(""),U=Object(o.a)(N,2),E=U[0],T=U[1];return Object(f.useEffect)((function(){document.title=t("title:connectRedirect")}),[t]),Object(f.useEffect)((function(){var e=function(){var e=Object(c.a)(i.a.mark((function e(){var r,n,c,o,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,T(t("auth:connect.fetch_user_data")),e.next=4,w(a,x.search||"");case 4:return r=e.sent,v(r.jwt),n=r.user.avatarUrl,delete r.user.avatarUrl,l(r.user),e.next=11,C(r.jwt);case 11:if((c=e.sent).avatar||!n){e.next=33;break}return z(50),T(t("auth:connect.fetch_user_avatar")),e.next=17,b.a.get(n,{responseType:"blob"});case 17:return o=e.sent.data,(s=new FormData).append("files",o,n.substring(n.lastIndexOf("/")+1)),s.append("refId",String(c.id)),s.append("ref","user-metadata"),s.append("field","avatar"),e.next=25,I(s,r.jwt);case 25:return z(75),e.t0=O,e.next=29,C(r.jwt);case 29:e.t1=e.sent,(0,e.t0)(e.t1),e.next=35;break;case 33:O(c),z(100);case 35:k.push("/user"),localStorage.setItem("lastUserCheck",String((new Date).getTime())),e.next=42;break;case 39:e.prev=39,e.t2=e.catch(0),"Auth.form.error.email.taken"===e.t2.id&&k.replace("/user/login?error=".concat(t("auth:error.email_taken")));case 42:case"end":return e.stop()}}),e,null,[[0,39]])})));return function(){return e.apply(this,arguments)}}();x.search&&e()}),[]),Object(r.jsxs)(f.Fragment,{children:[Object(r.jsx)(s.a,{variant:"h6",className:e.header,children:t("auth:connect.redirect")}),Object(r.jsxs)(d.a,{container:!0,spacing:1,children:[Object(r.jsx)(d.a,{item:!0,xs:12,children:Object(r.jsx)(s.a,{children:E})}),Object(r.jsx)(d.a,{item:!0,xs:12,children:Object(r.jsx)(u.a,{variant:"determinate",value:B})})]})]})}},292:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var r=a(198),n=Object(r.a)((function(e){return{header:{fontWeight:"bold"},content:{marginTop:e.spacing(3),marginBottom:e.spacing(3),marginLeft:"auto",marginRight:"auto"},alert:{margin:e.spacing(1,0)},bold:{fontWeight:e.typography.fontWeightBold},capitalize:{textTransform:"capitalize"},tabpanel:{padding:e.spacing("1%",0,0,0)},"grid-out":{padding:e.spacing("1%","0")}}}))},473:function(e,t,a){"use strict";var r=a(2),n=a(3),i=a(0),c=(a(6),a(4)),o=a(10),s=a(7),d=a(17),u=a(20),l=i.forwardRef((function(e,t){var a=e.classes,s=e.className,d=e.color,l=void 0===d?"primary":d,b=e.value,f=e.valueBuffer,m=e.variant,p=void 0===m?"indeterminate":m,g=Object(n.a)(e,["classes","className","color","value","valueBuffer","variant"]),h=Object(u.a)(),j={},v={bar1:{},bar2:{}};if("determinate"===p||"buffer"===p)if(void 0!==b){j["aria-valuenow"]=Math.round(b),j["aria-valuemin"]=0,j["aria-valuemax"]=100;var O=b-100;"rtl"===h.direction&&(O=-O),v.bar1.transform="translateX(".concat(O,"%)")}else 0;if("buffer"===p)if(void 0!==f){var x=(f||0)-100;"rtl"===h.direction&&(x=-x),v.bar2.transform="translateX(".concat(x,"%)")}else 0;return i.createElement("div",Object(r.a)({className:Object(c.a)(a.root,a["color".concat(Object(o.a)(l))],s,{determinate:a.determinate,indeterminate:a.indeterminate,buffer:a.buffer,query:a.query}[p]),role:"progressbar"},j,{ref:t},g),"buffer"===p?i.createElement("div",{className:Object(c.a)(a.dashed,a["dashedColor".concat(Object(o.a)(l))])}):null,i.createElement("div",{className:Object(c.a)(a.bar,a["barColor".concat(Object(o.a)(l))],("indeterminate"===p||"query"===p)&&a.bar1Indeterminate,{determinate:a.bar1Determinate,buffer:a.bar1Buffer}[p]),style:v.bar1}),"determinate"===p?null:i.createElement("div",{className:Object(c.a)(a.bar,("indeterminate"===p||"query"===p)&&a.bar2Indeterminate,"buffer"===p?[a["color".concat(Object(o.a)(l))],a.bar2Buffer]:a["barColor".concat(Object(o.a)(l))]),style:v.bar2}))}));t.a=Object(s.a)((function(e){var t=function(t){return"light"===e.palette.type?Object(d.i)(t,.62):Object(d.a)(t,.5)},a=t(e.palette.primary.main),r=t(e.palette.secondary.main);return{root:{position:"relative",overflow:"hidden",height:4,"@media print":{colorAdjust:"exact"}},colorPrimary:{backgroundColor:a},colorSecondary:{backgroundColor:r},determinate:{},indeterminate:{},buffer:{backgroundColor:"transparent"},query:{transform:"rotate(180deg)"},dashed:{position:"absolute",marginTop:0,height:"100%",width:"100%",animation:"$buffer 3s infinite linear"},dashedColorPrimary:{backgroundImage:"radial-gradient(".concat(a," 0%, ").concat(a," 16%, transparent 42%)"),backgroundSize:"10px 10px",backgroundPosition:"0 -23px"},dashedColorSecondary:{backgroundImage:"radial-gradient(".concat(r," 0%, ").concat(r," 16%, transparent 42%)"),backgroundSize:"10px 10px",backgroundPosition:"0 -23px"},bar:{width:"100%",position:"absolute",left:0,bottom:0,top:0,transition:"transform 0.2s linear",transformOrigin:"left"},barColorPrimary:{backgroundColor:e.palette.primary.main},barColorSecondary:{backgroundColor:e.palette.secondary.main},bar1Indeterminate:{width:"auto",animation:"$indeterminate1 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite"},bar1Determinate:{transition:"transform .".concat(4,"s linear")},bar1Buffer:{zIndex:1,transition:"transform .".concat(4,"s linear")},bar2Indeterminate:{width:"auto",animation:"$indeterminate2 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) 1.15s infinite"},bar2Buffer:{transition:"transform .".concat(4,"s linear")},"@keyframes indeterminate1":{"0%":{left:"-35%",right:"100%"},"60%":{left:"100%",right:"-90%"},"100%":{left:"100%",right:"-90%"}},"@keyframes indeterminate2":{"0%":{left:"-200%",right:"100%"},"60%":{left:"107%",right:"-8%"},"100%":{left:"107%",right:"-8%"}},"@keyframes buffer":{"0%":{opacity:1,backgroundPosition:"0 -23px"},"50%":{opacity:0,backgroundPosition:"0 -23px"},"100%":{opacity:1,backgroundPosition:"-200px -23px"}}}}),{name:"MuiLinearProgress"})(l)}}]);